(function(c,a){window.si=window.si||{};si.ajax=function(c,h,u,i){return a.ajax({type:"POST",cache:!1,url:c,data:h,contentType:"application/json; charset=utf-8",dataType:"json",success:u,error:i})};si.loadingGif='<img src="/img/loading.gif" />';a(function(){var c=a("body").attr("id"),h=a("nav a");"home"!==c&&h.filter('[href*="'+c+'"]').addClass("selected");a(".logout").live("click",function(a){a.preventDefault();si.ajax("/webservices/wsUser.asmx/siUserLogout",{},function(a){a&&a.d&&"success"===a.d? window.location="/":alert("An error occured. "+(a&&a.d)?a.d:"Please try refreshing the page.")},function(){alert("An error occured. Please try refreshing the page.")})})})})(document,jQuery);window.log=function(){log.history=log.history||[];log.history.push(arguments);if(this.console){arguments.callee=arguments.callee.caller;var c=[].slice.call(arguments);"object"===typeof console.log?log.apply.call(console.log,console,c):console.log.apply(console,c)}}; (function(c){function a(){}for(var r="assert,clear,count,debug,dir,dirxml,error,exception,firebug,group,groupCollapsed,groupEnd,info,log,memoryProfile,memoryProfileEnd,profile,profileEnd,table,time,timeEnd,timeStamp,trace,warn".split(","),h;h=r.pop();)c[h]=c[h]||a})(function(){try{return console.log(),window.console}catch(c){return window.console={}}}());if(!this.JSON)this.JSON={}; (function(){function c(a){return 10>a?"0"+a:a}function a(a){u.lastIndex=0;return u.test(a)?'"'+a.replace(u,function(a){var e=B[a];return"string"===typeof e?e:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function r(c,o){var e,d,k,g,h=i,l,b=o[c];b&&"object"===typeof b&&"function"===typeof b.toJSON&&(b=b.toJSON(c));"function"===typeof p&&(b=p.call(o,c,b));switch(typeof b){case "string":return a(b);case "number":return isFinite(b)?""+b:"null";case "boolean":case "null":return""+ b;case "object":if(!b)return"null";i+=s;l=[];if("[object Array]"===Object.prototype.toString.apply(b)){g=b.length;for(e=0;e<g;e+=1)l[e]=r(e,b)||"null";k=0===l.length?"[]":i?"[\n"+i+l.join(",\n"+i)+"\n"+h+"]":"["+l.join(",")+"]";i=h;return k}if(p&&"object"===typeof p){g=p.length;for(e=0;e<g;e+=1)d=p[e],"string"===typeof d&&(k=r(d,b))&&l.push(a(d)+(i?": ":":")+k)}else for(d in b)Object.hasOwnProperty.call(b,d)&&(k=r(d,b))&&l.push(a(d)+(i?": ":":")+k);k=0===l.length?"{}":i?"{\n"+i+l.join(",\n"+i)+"\n"+ h+"}":"{"+l.join(",")+"}";i=h;return k}}if("function"!==typeof Date.prototype.toJSON)Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+c(this.getUTCMonth()+1)+"-"+c(this.getUTCDate())+"T"+c(this.getUTCHours())+":"+c(this.getUTCMinutes())+":"+c(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()};var h=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, u=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,s,B={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},p;if("function"!==typeof JSON.stringify)JSON.stringify=function(a,c,e){var d;s=i="";if("number"===typeof e)for(d=0;d<e;d+=1)s+=" ";else"string"===typeof e&&(s=e);if((p=c)&&"function"!==typeof c&&("object"!==typeof c||"number"!==typeof c.length))throw Error("JSON.stringify");return r("", {"":a})};if("function"!==typeof JSON.parse)JSON.parse=function(a,c){function e(a,g){var d,h,b=a[g];if(b&&"object"===typeof b)for(d in b)Object.hasOwnProperty.call(b,d)&&(h=e(b,d),void 0!==h?b[d]=h:delete b[d]);return c.call(a,g,b)}var d;h.lastIndex=0;h.test(a)&&(a=a.replace(h,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return d=eval("("+a+")"),"function"===typeof c?e({"":d},""):d;throw new SyntaxError("JSON.parse");}})(); (function(c,a){function r(){e.on("click",function(a){a.preventDefault();n=-1;C.html("Post a New Blog");x.hide();o.hide();j.show().find("input:text:first").focus()});d.on("click",function(a){a.preventDefault();o.hide();k.show()})}function h(){G.on("click",function(a){a.preventDefault();a=parseInt(g.val(),10);0<a?(b.html('<p class="status-working">Loading blog details...&nbsp;'+si.loadingGif+"</p>"),n=a,si.ajax("/webservices/wsBlog.asmx/selectBlogs",JSON.stringify({blogId:n,webUrl:"",tagId:-1,categoryId:-1}), function(a){if(a&&a.d){var f=a.d[0].cols;si.ajax("/webservices/wsBlog.asmx/loadTagsByBlog",JSON.stringify({blogId:n}),function(a){if(a&&a.d){for(var a=a.d,c=0,d=a.length;c<d;c++)t.find('option[value="'+a[c].cols.tagId+'"]').attr("selected","selected");v.val(f.title||"");D.val(f.metadesc||"");E.val(f.metakeywords||"");F.val(f.projectUrl||"");y.val(f.body||"");q.val(f.categoryId||"-1");f.isActive?w.attr("checked","checked"):w.removeAttr("checked");C.html("Edit Blog");x.show().data("web-url",f.webUrl); k.hide();j.show();b.html("")}else b.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>')},function(){b.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>')})}else b.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>')},function(){b.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>')})):b.html('<p class="status-error">You must select a blog to edit.</p>')}); l.on("click",function(a){a.preventDefault();o.show();k.hide();g.val("-1")})}function u(){y.ckeditor({width:"598px",height:"450px"});q.on("change",function(){"1"!==a(this).val()&&t.find("option:selected").removeAttr("selected")});H.on("click",function(f){f.preventDefault();var b=!1,f="";j.find("input:text, textarea").each(function(){var f=a(this),c=a.trim(f.val());f.val(c);if(-1!==this.className.indexOf("req")&&0===c.length)-1===this.className.indexOf("error")&&(this.className+=" error"),b=!0,log(this.value); else if(-1!==this.className.indexOf("error"))this.className=this.className.replace("error","")});b&&(f="All fields marked with an * are required.<br />");"-1"===q.val()&&(b=!0,f+="You must select a category.");1===parseInt(q.val(),10)&&!t.val()&&(b=!0,f+="You must select at least one tag for a project.<br />");b||""!==f?(m.html('<p class="status-error">'+f+"</p>"),j.find(".error:first").focus()):(j.find("input, textarea, button").attr("disabled","disabled"),m.html('<p class="status-working">Saving blog...&nbsp;'+ si.loadingGif+"</p>"),f=JSON.stringify({blogId:n,title:v.val(),body:y.val(),primaryPic:"",thumbPic:"",projectUrl:F.val(),metadesc:D.val(),metakeywords:E.val(),isActive:w.prop("checked"),tags:t.val()||["-1"],categoryId:parseInt(q.val())}),si.ajax("/webservices/wsBlog.asmx/saveBlog",f,function(a){a&&a.d?(a=a.d,isNaN(a)?(j.find("input, textarea, button").removeAttr("disabled"),m.html('<p class="status-error">'+a+"</p>")):(a=parseInt(a,10),s(!1,-1===n?a:-1),n=-1,m.html("<p>The blog has been saved successfully.</p>"), setTimeout(function(){j.hide().find("input, textarea, button").removeAttr("disabled");o.show();A()},1500))):(j.find("input, textarea, button").removeAttr("disabled"),m.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>'))},function(){j.find("input, textarea, button").removeAttr("disabled");m.html('<p class="status-error">An error has occured. Please try again or reload the page.</p>')}))});I.on("click",function(a){a.preventDefault();confirm("Are you sure you want to delete this blog?")&& (j.find("input, textarea, button").attr("disabled","disabled"),m.html('<p class="status-working">Deleting blog...&nbsp;'+si.loadingGif+"</p>"),si.ajax("/webservices/wsBlog.asmx/deleteBlog",JSON.stringify({blogId:n}),function(a){if(a&&a.d){var f=a.d;"success"===f.toLowerCase()?(m.html("<p>The blog has been deleted.</p>"),s(!0),n=-1,setTimeout(function(){j.hide().find("input, textarea, button").removeAttr("disabled");o.show();A()},1500)):(m.html('<p class="status-error">'+f+"</p>"),j.find("input, textarea, button").removeAttr("disabled"))}else m.html('<p class="status-error">'+ f+"</p>"),j.find("input, textarea, button").removeAttr("disabled")},function(){m.html('<p class="status-error">'+msg+"</p>");j.find("input, textarea, button").removeAttr("disabled")}))});J.on("click",function(a){a.preventDefault();j.hide();o.show();A()});x.on("click",function(f){f.preventDefault();window.open("/news/"+a(this).data("web-url"),"_blank")})}function i(){g.html('<option value="-1">Loading...</option>');si.ajax("/webservices/wsBLog.asmx/selectBlogs",JSON.stringify({blogId:-1,webUrl:"", tagId:-1,categoryId:-1}),function(a){if(a&&a.d)if(a=a.d,0<a.length){for(var b="",c=0,d=a.length;c<d;c++)var e=a[c].cols,b=b+('<option value="'+e.blogId+'">'+e.title+"</option>");g.html(b)}else g.html('<option value="-1">No blogs available.</option>');else g.html('<option value="-1">No blogs available.</option>')},function(){g.html('<option value="-1">No blogs available.</option>')})}function s(a,b){if(a)g.find('option[value="'+n+'"]').remove(),0===g.find("option").length&&g.html('<option value="-1">No blogs available.</option>'); else if(-1===n){var c='<option value="'+b+'">'+v.val()+"</option>";1===g.find("option").length&&"-1"==g.find("option:first").val()?g.html(c):g.append(c)}else g.find('option[value="'+n+'"]').text(v.val())}function B(){t.html('<option value="-1">Loading...</option>');si.ajax("/webservices/wsBlog.asmx/loadTags",JSON.stringify({tagId:-1}),function(a){if(a&&a.d){if(z=a.d,0<z.length){for(var a="",b=0,c=z.length;b<c;b++)var d=z[b].cols,a=a+('<option value="'+d.tagId+'">'+d.tagName+"</option>");t.html(a)}}else alert("No tags found. Please reload or check the database.")}, function(){alert("No tags found. Please reload or check the database.")})}function p(){q.html('<option value="-1">Loading...</option>');si.ajax("/webservices/wsBlog.asmx/loadCategories",JSON.stringify({categoryId:-1}),function(a){if(a&&a.d){if(a=a.d,0<a.length){for(var b='<option value="-1">Select a Category</option>',c=0,d=a.length;c<d;c++)var e=a[c].cols,b=b+('<option value="'+e.categoryId+'">'+e.categoryName+"</option>");q.html(b)}}else alert("No categories found. Please reload or check the database.")}, function(){alert("No categories found. Please reload or check the database.")})}function A(){j.find("input:text, textarea").val("");w.attr("checked","checked");t.find("option:selected").removeAttr("selected");q.val("-1");m.html("")}var o,e,d,k,g,G,l,b,j,C,v,D,E,F,y,t,q,w,H,I,J,x,m,z=[],n=-1;Array.prototype.remove=function(a,b){var c=this.slice((b||a)+1||this.length);this.length=0>a?this.length+a:a;return this.push.apply(this,c)};a(function(){o=a("#form-options");e=a("#btn-opt-new-blog");d=a("#btn-opt-edit-blog"); k=a("#form-select-blog");g=a("#ddl-blogs");G=a("#btn-edit-blog");l=a("#btn-cancel-edit-blog");b=a("#status-edit-blog");j=a("#form-blog");C=a("#form-blog-title");v=a("#tb-blog-title");D=a("#tb-blog-description");E=a("#tb-blog-keywords");F=a("#tb-blog-projURL");y=a("#ta-blog-body");t=a("#ddl-blog-tags");q=a("#ddl-blog-category");w=a("#cb-blog-is-active");H=a("#btn-save-blog");I=a("#btn-delete-blog");J=a("#btn-cancel-blog");x=a("#btn-preview-blog");m=a("#status-blog");i();B();p();r();h();u()})})(document, jQuery);